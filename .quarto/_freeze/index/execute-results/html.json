{
  "hash": "1d5336b6c711b0bb044dc87269119b6a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle-block-banner: true\ntitle: \"Regresja liniowa\"\nauthor: \"Mirosława Kołodziejczyk\"\ndate: \"2024-10-25\"\nformat: html\n---\n\n## Dane I\n\n## y = f(x)\n\nGenerowanie danych.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nx <- seq(1,50,1)+rnorm(50)\ny <- rnorm(50) + (x+15*rnorm(50))\n\ndf <- data.frame(x,y)\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          x          y\n1 0.3735462  -8.533848\n2 2.1836433   2.203355\n3 2.1643714 -11.158334\n4 5.5952808   6.836349\n5 5.3295078  -3.056238\n6 5.1795316  33.669241\n```\n\n\n:::\n:::\n\n::: {#tbl-1 .cell tbl-cap='Dane wyjściowe do regresji liniowej y = f(x)'}\n\n```{.r .cell-code}\nif (!require(reactable)) {install.packages('reactable', \n                        repos=\"http://cran.us.r-project.org\"); require(reactable)}\n\nreactable(df)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-78481a280eb8253d8583\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-78481a280eb8253d8583\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"x\":[0.373546189257668,2.18364332422208,2.16437138758995,5.59528080213779,5.32950777181536,5.17953161588198,7.48742905242849,8.73832470512922,9.57578135165349,9.69461161284364,12.5117811684508,12.3898432364114,12.3787594194582,11.7853001128225,16.1249309181431,15.9550663909848,16.9838097369011,18.9438362106853,19.8212211950981,20.5939013212175,21.9189773716082,22.7821363007311,23.0745649833652,22.0106483041366,25.6198257478947,25.943871260471,26.8442044932947,26.5292476161007,28.5218499448914,30.4179415601997,32.358679551529,31.897212272657,33.3876716115594,33.9461949594171,33.6229404431714,35.5850054367003,36.6057100462897,37.9406866032888,40.1000253719839,40.7631757484575,40.8354764037464,41.7466383198635,43.6969633754047,44.5566631986737,44.3112443054505,45.2925048430379,47.3645819621368,48.7685329245154,48.8876537878498,50.8811077264542],\"y\":[-8.53384808873713,2.20335502813484,-11.1583336492723,6.83634929211812,-3.05623818526587,33.6692405549775,17.8708197162201,21.3468035212411,15.9082813464911,34.7921982167541,5.37735211972097,5.42593227826977,34.5527323600339,2.05285697194767,12.2709465552312,10.2517397488694,10.3789580797824,16.2226915275998,27.3872995023274,20.1065557575356,14.805124968794,42.2177722473654,20.4666002086512,18.3832027218416,22.8633312294522,36.9253121017595,25.2974465581813,25.9658403957266,18.3712840877082,24.9643665303168,32.6924174252283,22.9286163636382,42.5382014976212,9.64671693218552,38.8152545426463,12.8712084548501,33.1541679810169,29.7123041129794,30.6886224716852,40.1768228715189,11.5775649875546,60.6032558061251,19.8827794479196,38.3039208261029,29.1592761843486,34.5887062507015,77.395487938104,48.4562018056773,28.3685332164365,25.7986240737362]},\"columns\":[{\"id\":\"x\",\"name\":\"x\",\"type\":\"numeric\"},{\"id\":\"y\",\"name\":\"y\",\"type\":\"numeric\"}],\"dataKey\":\"961eeb5dbab2c9f96ef3893a98eeea11\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n## Wykres danych\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Dane podlegające regresji](index_files/figure-html/fig-1-1.png){#fig-1 width=672}\n:::\n:::\n\n\n## **Korelacja danych**\n\nWspółczynnik korelacji Pearsona: <https://pogotowiestatystyczne.pl/slowniki/korelacja-pearsona/>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkorelacja <- cor(x,y)\ncat(paste(\"Współczynnik korelacji Pearsona r = \", as.character(korelacja)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWspółczynnik korelacji Pearsona r =  0.627714002970246\n```\n\n\n:::\n\n```{.r .cell-code}\nif (korelacja >=0.7){\n  cat(\"Wniosek: korelacja bardzo silna\")\n} else if (korelacja < 0.7 & korelacja >= 0.5){\n  cat(\"Wniosek: korelacja silna\")\n} else if (korelacja < 0.5 & korelacja >= 0.3){\n  cat(\"Wniosek: korelacja umiarkowana\")\n} else {\n    cat(\"Wniosek: korelacja słaba\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWniosek: korelacja silna\n```\n\n\n:::\n:::\n\n\n## **Regresja liniowa**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_liniowy <- lm(y ~ x, data=df) \n\ncat(\"Model liniowy danych: y = a + b*x\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel liniowy danych: y = a + b*x\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_liniowy\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x, data = df)\n\nCoefficients:\n(Intercept)            x  \n     5.2394       0.7106  \n```\n\n\n:::\n\n```{.r .cell-code}\na<-round(model_liniowy$coefficients[1],5)\nb<-round(model_liniowy$coefficients[2],5)\ncat(paste(\"a = \", as.character(a)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\na =  5.23936\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(paste(\"b = \", as.character(b)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nb =  0.71058\n```\n\n\n:::\n:::\n\n\n## Wykres prostej regresji\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(x,y, font.main = 1,main = paste(\"Model liniowy danych: y = a + b*x\\n\",\"a = \",\n                  as.character(a),\"\\nb = \", as.character(b)))\nabline(model_liniowy,col = \"blue\")\n```\n\n::: {.cell-output-display}\n![Regresja liniowa y = a + b*x](index_files/figure-html/fig-2-1.png){#fig-2 width=672}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"site_libs/react-18.2.0/react.min.js\"></script>\n<script src=\"site_libs/react-18.2.0/react-dom.min.js\"></script>\n<script src=\"site_libs/reactwidget-2.0.0/react-tools.umd.cjs\"></script>\n<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"site_libs/reactable-0.4.4/reactable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/reactable-binding-0.4.4/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}